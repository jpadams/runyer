module MCollective
  module Agent
    class <%= @action_name.capitalize %><RPC::Agent
      activate_when do
        <%= @activate_condition %> 
      end

      action "run" do
        args = request[:args]
        args ||= ''
        command = '<%= (@cmd_prefix+' '+@command+' '+args).strip %>'
        reply[:status] = run(command,:stdout => :out, :stderr => :err, :chomp => true)
      end
    end
  end
end
